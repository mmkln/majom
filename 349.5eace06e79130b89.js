"use strict";(self.webpackChunkplatform_frontend=self.webpackChunkplatform_frontend||[]).push([[349],{2349:(Dt,O,s)=>{s.r(O),s.d(O,{SettingsModule:()=>_t});var d=s(1368),l=s(6504),P=s(5188),E=s(6052),W=s(1152),D=s(4336),c=s(5488),v=s(8212),X=s(2716),z=s(2604),w=s(2064),I=s(2531),t=s(4496),G=s(3480),g=s(9768),K=s(2088),M=s(3616),h=s(9212),C=s(5084),k=s(9144),j=s(7512),f=s(7936),Q=s(5e3),R=s(3012),F=s(776),B=s(2528),$=s(1800),J=s(4680),Z=s(8987),x=s(3656),A=s(4108),m=s(3496),Y=s(5944),q=s(3972),tt=s(9371),et=s(8960),it=s(6040),S=s(4704),U=s(5568),_=s(1040);function nt(e,a){if(1&e){const i=t.KQA();t.I0R(0,"tui-svg",7),t.qCj("click",function(){t.usT(i);const o=t.GaO(3);return t.CGJ(o.togglePasswordVisibility())}),t.wVc(1,"async"),t.C$Y()}if(2&e){const i=a.polymorpheusOutlet,n=t.GaO().ngIf,o=t.Gew(3),r=t.GaO(2);t.E7m("src",i)("tuiHint",n[0]&&n[1]&&o)("tuiHintAppearance",t.kDX(1,4,r.computedAppearance$)||"")("tuiHintDirection",(null==r.hintOptions?null:r.hintOptions.direction)||"bottom-left")}}function st(e,a){if(1&e&&t.OEk(0),2&e){const i=t.GaO().ngIf,n=t.GaO(2);t.oRS(" ",n.isPasswordHidden?i[0]:i[1]," ")}}const ot=e=>({$implicit:e});function at(e,a){if(1&e&&(t.SAx(0),t.yuY(1,nt,2,6,"tui-svg",4)(2,st,1,1,"ng-template",5,6,t.gJz),t.k70()),2&e){const i=t.GaO(2);t.yG2(),t.E7m("polymorpheusOutlet",i.icon)("polymorpheusOutletContext",t.S45(2,ot,i.size))}}function rt(e,a){if(1&e&&(t.yuY(0,at,4,4,"ng-container",3),t.wVc(1,"async")),2&e){const i=t.GaO();t.E7m("ngIf",t.kDX(1,1,i.passwordTexts$))}}const lt=["*",[["input"]]],ut=["*","input"],b=(0,B.AL)({icons:{hide:({$implicit:e})=>"s"===e?"tuiIconEyeOff":"tuiIconEyeOffLarge",show:({$implicit:e})=>"s"===e?"tuiIconEye":"tuiIconEyeLarge"}});let ct=(()=>{class e extends $._y{constructor(i,n,o,r,u,Tt,Ot){var T;super(i,n),this.textfieldSize=o,this.passwordTexts$=r,this.options=u,this.hintOptions=Tt,this.mode$=Ot,this.directive$=(null===(T=this.hintOptions)||void 0===T?void 0:T.change$)||et.k,this.isPasswordHidden=!0,this.computedAppearance$=(0,it.E)([this.mode$.pipe((0,S.k)(p=>"onDark"===p?"onDark":"")),this.directive$.pipe((0,U.W)(null),(0,S.k)(()=>{var p;return(null===(p=this.hintOptions)||void 0===p?void 0:p.appearance)||""}))]).pipe((0,S.k)(([p,Et])=>Et||p),(0,U.W)(""))}get size(){return this.textfieldSize.size}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){var i;return!(null===(i=this.textfield)||void 0===i||!i.focused)}get icon(){return this.isPasswordHidden?this.options.icons.hide:this.options.icons.show}get inputType(){return this.isPasswordHidden||!this.interactive?"password":"text"}onValueChange(i){this.value=i}onFocused(i){this.updateFocused(i)}togglePasswordVisibility(){this.isPasswordHidden=!this.isPasswordHidden}getFallbackValue(){return""}}return e.\u0275fac=function(i){return new(i||e)(t.GI1(l.eq,10),t.GI1(t.kD9),t.GI1(c.$K),t.GI1(R.M9),t.GI1(b),t.GI1(m.cb,8),t.GI1(Y.Yx))},e.\u0275cmp=t.In1({type:e,selectors:[["tui-input-password"]],viewQuery:function(i,n){if(1&i&&t.CC$(f.y_,5),2&i){let o;t.wto(o=t.Gqi())&&(n.textfield=o.first)}},hostVars:1,hostBindings:function(i,n){2&i&&t.e48("data-size",n.size)},features:[t.M5G([(0,J.NK)(e),(0,$.q4)(e),q.Ir]),t.eg9],ngContentSelectors:ut,decls:5,vars:11,consts:[[1,"t-textfield",3,"disabled","focusable","invalid","nativeId","pseudoActive","pseudoFocus","pseudoHover","readOnly","tuiTextfieldIcon","value","valueChange","focusedChange"],[3,"polymorpheus"],["iconContent","polymorpheus"],[4,"ngIf"],["appearance","icon","automation-id","tui-password__icon","tuiWrapper","","class","t-icon",3,"src","tuiHint","tuiHintAppearance","tuiHintDirection","click",4,"polymorpheusOutlet","polymorpheusOutletContext"],["polymorpheus",""],["hintContent","polymorpheus"],["appearance","icon","automation-id","tui-password__icon","tuiWrapper","",1,"t-icon",3,"src","tuiHint","tuiHintAppearance","tuiHintDirection","click"]],template:function(i,n){if(1&i&&(t.kPM(lt),t.I0R(0,"tui-primitive-textfield",0),t.iHE("valueChange",function(r){return t.kNx(n.value,r)||(n.value=r),r}),t.qCj("focusedChange",function(r){return n.onFocused(r)}),t._Xx(1),t._Xx(2,1,["ngProjectAs","input",5,["input"]]),t.C$Y(),t.yuY(3,rt,2,3,"ng-template",1,2,t.gJz)),2&i){const o=t.Gew(4);t.E7m("disabled",n.computedDisabled)("focusable",n.focusable)("invalid",n.computedInvalid)("nativeId",n.nativeId)("pseudoActive",n.pseudoActive)("pseudoFocus",n.pseudoFocus)("pseudoHover",n.pseudoHover)("readOnly",n.readOnly)("tuiTextfieldIcon",n.interactive?o:""),t.OKB("value",n.value),t.yG2(3),t.E7m("polymorpheus",n.type)}},dependencies:[f.y_,x.Wu,f.KQ,c.uU,_.sv,d.u_,_.Af,A.S,m.lh,m.SL,m.i6,m.IT,d.a],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-icon[_ngcontent-%COMP%]{cursor:pointer;pointer-events:auto}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}"],changeDetection:0}),e})(),dt=(()=>{class e extends tt.Cm{onValueChange(i){this.host.onValueChange(i)}process(i){this.input=i}ngDoCheck(){this.host.nativeFocusableElement&&(0,Z.kZ)(this.host.nativeFocusableElement)&&(this.host.nativeFocusableElement.type=this.host.inputType)}}return e.\u0275fac=(()=>{let a;return function(n){return(a||(a=t.otF(e)))(n||e)}})(),e.\u0275dir=t.Sc5({type:e,selectors:[["tui-input-password"]],features:[t.M5G([(0,Y.iu)(e)]),t.eg9]}),e})(),pt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.a4G({type:e}),e.\u0275inj=t.s3X({imports:[[d.MD,l.y,_.Ux,A.g,x.Yt,m.WY,f.KA,c.aS]]}),e})();var L=s(4080),gt=s(8444);let H=(()=>{class e{constructor(i){this.fb=i}buildForm(){const i=this.getDefaultValue();return this.form=this.fb.group({oldPassword:this.fb.control(i.oldPassword,[l.AQ.required]),newPassword:this.fb.control(i.newPassword,[l.AQ.required,l.AQ.minLength(8)]),confirmPassword:this.fb.control(i.confirmPassword,[l.AQ.required])},{validators:[(0,gt.k)("newPassword","confirmPassword")]})}getDefaultValue(){return{oldPassword:"",newPassword:"",confirmPassword:""}}getFormRawValue(){return this.form?.getRawValue()}static#t=this.\u0275fac=function(n){return new(n||e)(t.CoB(l.WW))};static#e=this.\u0275prov=t.wxM({token:e,factory:e.\u0275fac})}return e})();const mt={required:"This field is required",password:"Password must be at least 8 characters long",passwordsNotMatching:"Passwords do not match",minlength:"Password must be at least 8 characters long",changePasswordFailed:"Change password failed"};var ht=s(9204);const y=()=>[];let N=(()=>{class e{constructor(i){this.formService=i,this.loading=!1,this.autService=(0,t.uUt)(ht.o),this.notificationsService=(0,t.uUt)(g.E3),this.formService.buildForm()}onUpdatePassword(){this.loading=!0;const{oldPassword:i,newPassword:n,confirmPassword:o}=this.formService.getFormRawValue();this.autService.changePassword(i,n,o).pipe((0,C.K)(),(0,h.y)(()=>{this.loading=!1,this.notificationsService.showNotification("Password updated successfully","success")}),(0,k.a)(r=>(this.loading=!1,this.formService.form.setErrors({changePasswordFailed:!0}),this.notificationsService.showNotification("Password not updated. An error occurred","error"),r))).subscribe()}static#t=this.\u0275fac=function(n){return new(n||e)(t.GI1(H))};static#e=this.\u0275cmp=t.In1({type:e,selectors:[["xx-change-password-form"]],standalone:!0,features:[t.M5G([H,{provide:R.Mn,useValue:{...mt}}]),t.UHJ],decls:24,vars:31,consts:[[3,"formGroup"],[1,"w-96","max-w-full"],["tuiTextfieldSize","m","formControlName","oldPassword",1,"mt-3"],["formControlName","oldPassword",3,"error"],["tuiTextfieldSize","m","formControlName","newPassword",1,"mt-3"],["formControlName","newPassword",3,"error"],["tuiTextfieldSize","m","formControlName","confirmPassword",1,"mt-3"],[3,"formGroup","error"],["formControlName","confirmPassword",3,"error"],[1,"mt-4"],["appearance","primary","tuiButton","","type","button","size","m",3,"showLoader","disabled","click"]],template:function(n,o){1&n&&(t.I0R(0,"form",0)(1,"div",1)(2,"tui-input-password",2),t.OEk(3," Old password "),t.C$Y(),t.wR5(4,"tui-error",3),t.wVc(5,"async"),t.wVc(6,"tuiFieldError"),t.I0R(7,"tui-input-password",4),t.OEk(8," New password "),t.C$Y(),t.wR5(9,"tui-error",5),t.wVc(10,"async"),t.wVc(11,"tuiFieldError"),t.I0R(12,"tui-input-password",6),t.OEk(13," Confirm password "),t.C$Y(),t.wR5(14,"tui-error",7),t.wVc(15,"async"),t.wVc(16,"tuiFieldError"),t.wR5(17,"tui-error",8),t.wVc(18,"async"),t.wVc(19,"tuiFieldError"),t.C$Y()(),t.I0R(20,"div",9)(21,"button",10),t.qCj("click",function(){return o.onUpdatePassword()}),t.OEk(22),t.wVc(23,"translate"),t.C$Y()()),2&n&&(t.E7m("formGroup",o.formService.form),t.yG2(4),t.E7m("error",t.kDX(5,9,t.kDX(6,11,t.q4q(27,y)))),t.yG2(5),t.E7m("error",t.kDX(10,13,t.kDX(11,15,t.q4q(28,y)))),t.yG2(5),t.E7m("formGroup",o.formService.form)("error",t.kDX(15,17,t.kDX(16,19,t.q4q(29,y)))),t.yG2(3),t.E7m("error",t.kDX(18,21,t.kDX(19,23,t.q4q(30,y)))),t.yG2(4),t.E7m("showLoader",o.loading)("disabled",!o.formService.form.valid||o.loading),t.yG2(),t.oRS(" ",t.kDX(23,25,"update password")," "))},dependencies:[l.sl,l.sz,l.ue,l.u,l.uW,l.Wo,Q.m6,c.aS,c.rD,w.O0,w.sD,v.CI,v.Kw,d.a,L.Y,L.a,F.uY,F.Mr,pt,ct,dt]})}return e})();function ft(e,a){if(1&e&&t.wR5(0,"tui-data-list-wrapper",14),2&e){const i=t.GaO(),n=t.Gew(11);t.E7m("items",i.languageList)("itemContent",n)}}function vt(e,a){if(1&e&&(t.I0R(0,"div",15)(1,"span",16),t.OEk(2),t.C$Y()()),2&e){const i=a.$implicit;t.yG2(2),t.cNF(i.label)}}function wt(e,a){if(1&e&&t.wR5(0,"tui-data-list-wrapper",14),2&e){const i=t.GaO(),n=t.Gew(22);t.E7m("items",i.wallpaperService.wallpaperList)("itemContent",n)}}const Ct=e=>({"background-image":e});function yt(e,a){if(1&e&&(t.I0R(0,"div",15),t.wR5(1,"div",17),t.C$Y()),2&e){const i=a.$implicit;t.yG2(),t.E7m("ngStyle",t.S45(1,Ct,"url("+i.image_file+")"))}}function Pt(e,a){1&e&&(t.I0R(0,"div",18),t.wR5(1,"xx-change-password-form"),t.C$Y())}const It=[{path:"",component:(()=>{class e{constructor(){this.pageTitleService=(0,t.uUt)(g.M$),this.language=null,this.wallpaper=null,this.languageList=[{value:"ua",label:"Ukrainian"},{value:"en",label:"English"}],this.showChangePasswordForm=!1,this.languageService=(0,t.uUt)(g.ov),this.userApiService=(0,t.uUt)(K.s),this.destroy$=(0,t.uUt)(G.UF),this.wallpaperService=(0,t.uUt)(j.I),this.confirmationDialogService=(0,t.uUt)(g.wR),this.router=(0,t.uUt)(I.E5),this.tokenService=(0,t.uUt)(g.Ci),this.notificationsService=(0,t.uUt)(g.E3),this.defaultLanguage$=this.languageService.language$,this.stringifyLanguage=i=>i.label,this.languageIdentityMatcher=(i,n)=>i.value===n.value,this.stringifyWallpaper=i=>i.image_file,this.wallpaperIdentityMatcher=(i,n)=>i.id===n.id}ngOnInit(){this.pageTitleService.setPageTitle("Settings"),this.languageService.language$.pipe((0,M.a)(this.destroy$),(0,h.y)(i=>{this.setDefaultLanguage(i)})).subscribe(),this.wallpaperService.wallpaper$.pipe((0,M.a)(this.destroy$),(0,h.y)(i=>{this.wallpaper=i})).subscribe()}setDefaultLanguage(i){this.language=this.languageList.find(n=>n.value===i)||null}onLanguageChanged(i){this.userApiService.setUserProfileLanguage(i.value).pipe((0,C.K)()).subscribe(),this.languageService.setDefaultLanguage(i.value)}onWallpaperChanged(i){this.userApiService.setUserProfileWallpaper(i.id).pipe((0,C.K)()).subscribe(),this.wallpaperService.setDefaultWallpaper(i)}onDeleteAccount(){this.confirmationDialogService.openConfirmationDialog("Delete your account","Are you sure you want to delete this account?").pipe((0,h.y)(i=>{i&&this.deleteUserAccount()})).subscribe()}deleteUserAccount(){this.userApiService.deleteUser().pipe((0,C.K)(),(0,h.y)(()=>{this.notificationsService.showNotification("Your Profile successfully deleted","success"),this.tokenService.removeTokens(),this.router.navigate(["/login"])}),(0,k.a)(i=>i)).subscribe()}onChangePassword(){this.showChangePasswordForm=!this.showChangePasswordForm}static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275cmp=t.In1({type:e,selectors:[["xx-settings"]],features:[t.M5G([G.UF])],decls:46,vars:27,consts:[[1,"rounded-2xl","bg-white","dark:bg-slate-900","text-gray-600","dark:text-gray-400"],[1,"p-6"],[1,"text-lg","font-semibold"],[1,""],["tuiTextfieldSize","m",1,"mt-2",3,"ngModel","tuiTextfieldLabelOutside","stringify","identityMatcher","ngModelChange"],["placeholder","Choose platform language","tuiTextfield",""],[3,"items","itemContent",4,"tuiDataList"],["languageContent",""],["placeholder","Choose platform wallpaper","tuiTextfield",""],["wallpaperContent",""],[1,"mt-2"],["appearance","secondary","tuiButton","","type","button","size","m",3,"click"],["class","mt-4",4,"ngIf"],["appearance","accent","tuiButton","","type","button","size","m",3,"click"],[3,"items","itemContent"],[1,"flex","gap-2","items-center"],[1,"capitalize"],[1,"w-32","h-20","inset-0","bg-cover","bg-center","rounded",3,"ngStyle"],[1,"mt-4"]],template:function(n,o){1&n&&(t.I0R(0,"div",0)(1,"div",1)(2,"h3",2),t.OEk(3,"Language"),t.C$Y(),t.I0R(4,"span",3),t.OEk(5," Choose the language used to display menus, messages, and notifications from Majom. "),t.C$Y(),t.I0R(6,"tui-select",4),t.iHE("ngModelChange",function(u){return t.kNx(o.language,u)||(o.language=u),u}),t.qCj("ngModelChange",function(u){return o.onLanguageChanged(u)}),t.OEk(7," Language "),t.wR5(8,"input",5),t.yuY(9,ft,1,2,"tui-data-list-wrapper",6)(10,vt,3,1,"ng-template",null,7,t.gJz),t.C$Y()(),t.I0R(12,"div",1)(13,"h3",2),t.OEk(14,"Wallpaper"),t.C$Y(),t.I0R(15,"span",3),t.OEk(16," Choose the wallpaper used to display on Majom. "),t.C$Y(),t.I0R(17,"tui-select",4),t.iHE("ngModelChange",function(u){return t.kNx(o.wallpaper,u)||(o.wallpaper=u),u}),t.qCj("ngModelChange",function(u){return o.onWallpaperChanged(u)}),t.OEk(18," Wallpaper "),t.wR5(19,"input",8),t.yuY(20,wt,1,2,"tui-data-list-wrapper",6)(21,yt,2,3,"ng-template",null,9,t.gJz),t.C$Y()(),t.I0R(23,"div",1)(24,"h3",2),t.OEk(25),t.wVc(26,"translate"),t.C$Y(),t.I0R(27,"span",3),t.OEk(28),t.wVc(29,"translate"),t.C$Y(),t.I0R(30,"div",10)(31,"button",11),t.qCj("click",function(){return o.onChangePassword()}),t.OEk(32),t.wVc(33,"translate"),t.C$Y()(),t.yuY(34,Pt,2,0,"div",12),t.C$Y(),t.I0R(35,"div",1)(36,"h3",2),t.OEk(37),t.wVc(38,"translate"),t.C$Y(),t.I0R(39,"span",3),t.OEk(40),t.wVc(41,"translate"),t.C$Y(),t.I0R(42,"div",10)(43,"button",13),t.qCj("click",function(){return o.onDeleteAccount()}),t.OEk(44),t.wVc(45,"translate"),t.C$Y()()()()),2&n&&(t.yG2(6),t.OKB("ngModel",o.language),t.E7m("tuiTextfieldLabelOutside",!0)("stringify",o.stringifyLanguage)("identityMatcher",o.languageIdentityMatcher),t.yG2(11),t.OKB("ngModel",o.wallpaper),t.E7m("tuiTextfieldLabelOutside",!0)("stringify",o.stringifyWallpaper)("identityMatcher",o.wallpaperIdentityMatcher),t.yG2(8),t.cNF(t.kDX(26,15,"password")),t.yG2(3),t.oRS(" ",t.kDX(29,17,"change password message")," "),t.yG2(4),t.oRS(" ",t.kDX(33,19,o.showChangePasswordForm?"hide":"change password")," "),t.yG2(2),t.E7m("ngIf",o.showChangePasswordForm),t.yG2(3),t.cNF(t.kDX(38,21,"account")),t.yG2(3),t.oRS(" ",t.kDX(41,23,"delete account message")," "),t.yG2(4),t.oRS(" ",t.kDX(45,25,"delete your account")," "))},dependencies:[d.u_,d.Qt,P.cP,P.uO,f.b,l.ue,l._G,D.Ux,c.E9,c.rD,E.OO,v.Kw,N,w.sD]})}return e})()},{path:"user-profile",component:(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275cmp=t.In1({type:e,selectors:[["xx-user-profile"]],decls:2,vars:0,template:function(n,o){1&n&&(t.I0R(0,"p"),t.OEk(1,"user-profile works!"),t.C$Y())}})}return e})()}];let St=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.a4G({type:e});static#i=this.\u0275inj=t.s3X({imports:[I.qQ.forChild(It),I.qQ]})}return e})(),_t=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.a4G({type:e});static#i=this.\u0275inj=t.s3X({providers:[X.s],imports:[d.MD,St,P.my,l.y,W.M9,D.A$,c.aS,E.q8,z.e,v.CI,w.O0,N]})}return e})()}}]);